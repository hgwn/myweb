"use strict";describe("datepicker",function(){function e(e,t){e=p[e],angular.extend(r,angular.copy(e.scope||p["default"].scope),t);var o=$(e.element).appendTo(n);return o=a(o)(r),r.$digest(),jQuery(o[0])}function t(e,t){var n=$.Event("keydown");n.which=n.keyCode=t,angular.element(e[0]).triggerHandler(n)}var n,a,o,d,i,l,r,s,c,u=$("body");beforeEach(module("ngAnimate")),beforeEach(module("ngAnimateMock")),beforeEach(module("ngSanitize")),beforeEach(module("mgcrea.ngStrap.datepicker")),beforeEach(inject(function(e,t,p,m,g,b,f,y){r=t.$new(),a=p,o=m,d=e.get("$animate"),c=e.get("$timeout");var h=d.flush||d.triggerCallbacks;d.flush=function(){h.call(d),d.triggerCallbacks||c.flush()},i=b,s=new Date,u.html(""),n=$("<div>").attr("id","sandbox").appendTo(u),l=f})),afterEach(function(){r.$destroy(),n.remove()});var p={"default":{scope:{selectedDate:new Date},element:'<input type="text" ng-model="selectedDate" bs-datepicker>'},"default-with-namespace":{scope:{selectedDate:new Date},element:'<input type="text" ng-model="selectedDate" bs-datepicker data-prefix-event="modal">'},"default-with-id":{scope:{selectedDate:new Date},element:'<input id="datepicker1" type="text" ng-model="selectedDate" bs-datepicker>'},"value-past":{scope:{selectedDate:new Date(1986,1,22)},element:'<input type="text" ng-model="selectedDate" bs-datepicker>'},"markup-ngRepeat":{element:'<ul><li ng-repeat="i in [1, 2, 3]"><input type="text" ng-model="selectedDate" bs-datepicker></li></ul>'},"markup-ngChange":{scope:{selectedDate:new Date(1986,1,22),onChange:function(){}},element:'<input type="text" ng-model="selectedDate" ng-change="onChange()" bs-datepicker>'},"markup-ngRequired":{scope:{selectedDate:new Date(2010,1,22)},element:'<input type="text" ng-model="selectedDate" ng-required="true" bs-datepicker>'},"options-animation":{element:'<div class="btn" data-animation="am-flip-x" ng-model="datepickeredIcon" bs-datepicker></div>'},"options-placement":{element:'<div class="btn" data-placement="bottom" ng-model="datepickeredIcon" bs-datepicker></div>'},"options-placement-exotic":{element:'<div class="btn" data-placement="bottom-right" ng-model="datepickeredIcon" bs-datepicker></div>'},"options-trigger":{element:'<div class="btn" data-trigger="hover" ng-model="datepickeredIcon" bs-datepicker></div>'},"options-template":{element:'<input type="text" data-template-url="custom" ng-model="selectedDate" bs-datepicker>'},"options-typeStringDateFormat":{scope:{selectedDate:"22/02/1986"},element:'<input type="text" ng-model="selectedDate" data-date-type="string" data-date-format="dd/MM/yyyy" bs-datepicker>'},"options-typeStringDateFormatAlternative":{scope:{selectedDate:"2014-04-11"},element:'<input type="text" ng-model="selectedDate" data-date-type="string" data-date-format="yyyy-MM-dd" bs-datepicker>'},"options-typeNumberDateFormat":{scope:{selectedDate:+new Date(1986,2,22)},element:'<input type="text" ng-model="selectedDate" data-date-type="number" bs-datepicker>'},"options-typeUnixDateFormat":{scope:{selectedDate:new Date(1986,2,22)/1e3},element:'<input type="text" ng-model="selectedDate" data-date-type="unix" bs-datepicker>'},"options-typeIsoDateFormat":{scope:{selectedDate:"2014-12-26T13:03:08.631Z"},element:'<input type="text" ng-model="selectedDate" data-date-type="iso" bs-datepicker>'},"options-dateFormat":{scope:{selectedDate:new Date(1986,1,22)},element:'<input type="text" ng-model="selectedDate" data-date-format="yyyy-MM-dd" bs-datepicker>'},"options-dateFormat-alt":{scope:{selectedDate:new Date(1986,1,22)},element:'<input type="text" ng-model="selectedDate" data-date-format="EEEE MMMM d, yyyy" bs-datepicker>'},"options-timezone-utc":{element:'<input type="text" ng-model="selectedDate" data-date-format="yyyy-MM-dd" data-timezone="UTC" bs-datepicker>'},"options-strictFormat":{scope:{selectedDate:new Date(1986,1,4)},element:'<input type="text" ng-model="selectedDate" data-date-format="yyyy-M-d" data-strict-format="1" bs-datepicker>'},"options-named-dateFormat":{scope:{selectedDate:new Date(1986,1,22)},element:'<input type="text" ng-model="selectedDate" data-date-format="mediumDate" bs-datepicker>'},"options-minDate":{scope:{selectedDate:new Date(1986,1,22),minDate:"02/20/86"},element:'<input type="text" ng-model="selectedDate" data-min-date="{{minDate}}" bs-datepicker>'},"options-minDate-today":{scope:{selectedDate:new Date},element:'<input type="text" ng-model="selectedDate" data-min-date="today" bs-datepicker>'},"options-minDate-date":{scope:{selectedDate:new Date(1986,1,22),minDate:new Date(1986,1,20)},element:'<input type="text" ng-model="selectedDate" data-min-date="{{minDate}}" bs-datepicker>'},"options-minDate-number":{scope:{selectedDate:new Date(1986,1,22),minDate:+new Date(1986,1,20)},element:'<input type="text" ng-model="selectedDate" data-min-date="{{minDate}}" bs-datepicker>'},"options-maxDate":{scope:{selectedDate:new Date(1986,1,22),maxDate:"02/24/86"},element:'<input type="text" ng-model="selectedDate" data-max-date="{{maxDate}}" bs-datepicker>'},"options-maxDate-today":{scope:{selectedDate:new Date},element:'<input type="text" ng-model="selectedDate" data-max-date="today" bs-datepicker>'},"options-maxDate-date":{scope:{selectedDate:new Date(1986,1,22),maxDate:new Date(1986,1,24)},element:'<input type="text" ng-model="selectedDate" data-max-date="{{maxDate}}" bs-datepicker>'},"options-maxDate-number":{scope:{selectedDate:new Date(1986,1,22),maxDate:+new Date(1986,1,24)},element:'<input type="text" ng-model="selectedDate" data-max-date="{{maxDate}}" bs-datepicker>'},"options-startWeek":{scope:{selectedDate:new Date(2014,1,22),startWeek:1},element:'<input type="text" ng-model="selectedDate" data-start-week="{{startWeek}}" bs-datepicker>'},"options-startWeek-bis":{scope:{selectedDate:new Date(2014,6,15),startWeek:6},element:'<input type="text" ng-model="selectedDate" data-start-week="{{startWeek}}" bs-datepicker>'},"options-startDate":{scope:{startDate:"02/03/04"},element:'<input type="text" ng-model="selectedDate" data-start-date="{{startDate}}" bs-datepicker>'},"options-autoclose":{element:'<input type="text" ng-model="selectedDate" data-autoclose="{{autoclose}}" bs-datepicker>'},"options-useNative":{element:'<input type="text" ng-model="selectedDate" data-use-native="1" bs-datepicker>'},"options-modelDateFormat":{scope:{selectedDate:"2014-12-01"},element:'<input type="text" ng-model="selectedDate" data-date-format="dd/MM/yyyy" data-model-date-format="yyyy-MM-dd" data-date-type="string" bs-datepicker>'},"options-modelDateFormat-longDate":{scope:{selectedDate:"December 1, 2014"},element:'<input type="text" ng-model="selectedDate" data-date-format="shortDate" data-model-date-format="longDate" data-date-type="string" bs-datepicker>'},"options-daysOfWeekDisabled":{scope:{selectedDate:new Date(2014,6,27)},element:'<input type="text" ng-model="selectedDate" data-days-of-week-disabled="{{daysOfWeekDisabled}}" bs-datepicker>'},"options-daysOfWeekDisabled-bis":{scope:{selectedDate:new Date(2014,6,27),daysOfWeekDisabled:"0246"},element:'<input type="text" ng-model="selectedDate" data-days-of-week-disabled="{{daysOfWeekDisabled}}" bs-datepicker>'},"options-disabledDates":{scope:{selectedDate:new Date(2014,6,27)},element:'<input type="text" ng-model="selectedDate" data-disabled-dates="disabledDates" bs-datepicker>'},"options-disabledDates-minmax":{scope:{selectedDate:new Date(2014,6,27),minDate:new Date(2014,6,21),maxDate:new Date(2014,6,25)},element:'<input type="text" ng-model="selectedDate" data-disabled-dates="disabledDates" data-min-date="{{minDate}}" data-max-date="{{maxDate}}" bs-datepicker>'},"options-disabledDates-daysOfWeek":{scope:{selectedDate:new Date(2014,6,27),daysOfWeekDisabled:"0"},element:'<input type="text" ng-model="selectedDate" data-disabled-dates="disabledDates" data-days-of-week-disabled="{{daysOfWeekDisabled}}" bs-datepicker>'},"bsShow-attr":{scope:{selectedDate:new Date},element:'<input type="text" ng-model="selectedDate" bs-datepicker bs-show="true">'},"bsShow-binding":{scope:{isVisible:!1,selectedDate:new Date},element:'<input type="text" ng-model="selectedDate" bs-datepicker bs-show="isVisible">'},"options-container":{scope:{selectedDate:new Date},element:'<input type="text" data-container="{{container}}" ng-model="selectedDate" bs-datepicker>'}};describe("with default template",function(){it("should open on focus",function(){var t=e("default");expect(n.children(".dropdown-menu.datepicker").length).toBe(0),angular.element(t[0]).triggerHandler("focus"),expect(n.children(".dropdown-menu.datepicker").length).toBe(1)}),it("should close on blur",function(){var t=e("default");expect(n.children(".dropdown-menu.datepicker").length).toBe(0),angular.element(t[0]).triggerHandler("focus"),angular.element(t[0]).triggerHandler("blur"),expect(n.children(".dropdown-menu.datepicker").length).toBe(0)}),it("should close on ENTER keypress",function(){var a=e("default");expect(n.children(".dropdown-menu.datepicker").length).toBe(0),angular.element(a[0]).triggerHandler("focus"),c.flush(),t(a,13),expect(n.children(".dropdown-menu.datepicker").length).toBe(0)}),it("should correctly compile inner content",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody td").length).toBe(42),expect(n.find(".dropdown-menu tbody td .btn").length).toBe(42),expect(n.find(".dropdown-menu thead button:eq(1)").text()).toBe(i(s,"MMMM yyyy"));var a=(s.getDate(),1*n.find(".dropdown-menu tbody .btn:eq(0)").text());expect(new Date(s.getFullYear(),s.getMonth()-(1!==a?1:0),a).getDay()).toBe(l.defaults.startWeek)}),it("should correctly display active date",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),expect(1*n.find(".dropdown-menu tbody td .btn-primary").text().trim()).toBe(s.getDate()),expect(t.val()).toBe(s.getMonth()+1+"/"+s.getDate()+"/"+(s.getFullYear()+"").substr(2))}),it("should correctly select a new date",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(15)")[0]).triggerHandler("click"),expect(t.val()).toBe(s.getMonth()+1+"/15/"+(s.getFullYear()+"").substr(2))}),it("should correctly select the first day of the month",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu thead button:eq(2)")[0]).triggerHandler("click"),angular.element(n.find(".dropdown-menu tbody .btn:contains(01)")[0]).triggerHandler("click"),expect(1*n.find(".dropdown-menu tbody td .btn-primary").text().trim()).toBe(1),expect(t.val()).toBe(s.getMonth()+1+1+"/1/"+(s.getFullYear()+"").substr(2))}),it("should correctly set the model with manually typed value",function(){var t=e("default",{selectedDate:new Date(2014,1,10)});angular.element(t[0]).triggerHandler("focus"),t.val("11/30/14"),angular.element(t[0]).triggerHandler("change"),r.$digest(),expect(r.selectedDate).toEqual(new Date(2014,10,30)),expect(angular.element(t[0]).hasClass("ng-valid")).toBeTruthy()}),it("should invalidate input with non-existing manually typed value",function(){var t=e("default",{selectedDate:new Date(2014,1,10)});angular.element(t[0]).triggerHandler("focus"),t.val("02/31/14"),angular.element(t[0]).triggerHandler("change"),r.$digest(),expect(r.selectedDate).toBeUndefined(),expect(angular.element(t[0]).hasClass("ng-invalid")).toBeTruthy()}),it("should correctly be cleared when model is cleared",function(){var t=e("default");r.selectedDate=null,r.$digest(),expect(t.val()).toBe(""),r.selectedDate=new Date(1986,1,22),r.$digest(),expect(t.val()).toBe("2/22/86")}),it("should correctly change view month when selecting next month button",function(){var t=e("default");r.selectedDate=new Date(2014,0,31),r.$digest(),angular.element(t[0]).triggerHandler("focus");for(var a=1;12>a;a++)angular.element(n.find(".dropdown-menu thead button:eq(2)")[0]).triggerHandler("click"),expect(n.find(".dropdown-menu thead button:eq(1)").text()).toBe(i(new Date(2014,a,1),"MMMM yyyy"))}),it("should correctly change view month when selecting previous month button",function(){var t=e("default");r.selectedDate=new Date(2014,11,31),r.$digest(),angular.element(t[0]).triggerHandler("focus");for(var a=10;a>-1;a--)angular.element(n.find(".dropdown-menu thead button:eq(0)")[0]).triggerHandler("click"),expect(n.find(".dropdown-menu thead button:eq(1)").text()).toBe(i(new Date(2014,a,1),"MMMM yyyy"))}),it("should correctly navigate to upper month view",function(){var t=e("default");s.getDate(),s.getMonth(),angular.element(t[0]).triggerHandler("focus"),expect(r.$$childHead.$mode).toBe(0),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),expect(r.$$childHead.$mode).toBe(1)}),describe("once in month view",function(){it("should correctly compile inner content",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),expect(n.find(".dropdown-menu tbody td").length).toBe(12),expect(n.find(".dropdown-menu tbody .btn").length).toBe(12),expect(n.find(".dropdown-menu thead button:eq(1)").text()).toBe(i(s,"yyyy"))}),it("should correctly display active date",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),expect(n.find(".dropdown-menu tbody td .btn-primary").text()).toBe(i(s,"MMM"))})}),it("should correctly navigate to upper year view",function(){var t=e("default");s.getDate(),s.getMonth(),angular.element(t[0]).triggerHandler("focus"),expect(r.$$childHead.$mode).toBe(0),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),expect(r.$$childHead.$mode).toBe(2)}),describe("once in year view",function(){it("should correctly compile inner content",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),expect(n.find(".dropdown-menu tbody td").length).toBe(12),expect(n.find(".dropdown-menu tbody .btn").length).toBe(12)}),it("should correctly display active date",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),angular.element(n.find(".dropdown-menu thead button:eq(1)")[0]).triggerHandler("click"),expect(n.find(".dropdown-menu tbody td .btn-primary").text()).toBe(i(s,"yyyy"))})}),it("should correctly support null values",function(){var t=e("default",{selectedDate:null});angular.element(t[0]).triggerHandler("focus"),expect(t.val()).toBe(""),expect(n.find(".dropdown-menu tbody td").length).toBe(42),expect(n.find(".dropdown-menu tbody .btn").length).toBe(42),t.val("0"),angular.element(t[0]).triggerHandler("change")}),it("should correctly support undefined values",function(){var t=e("default",{selectedDate:void 0});angular.element(t[0]).triggerHandler("focus"),expect(t.val()).toBe(""),expect(n.find(".dropdown-menu tbody td").length).toBe(42),expect(n.find(".dropdown-menu tbody .btn").length).toBe(42),t.val("0"),angular.element(t[0]).triggerHandler("change")}),it("should correctly support invalid values",function(){var t=e("default");t.val("invalid"),angular.element(t[0]).triggerHandler("change"),angular.element(t[0]).triggerHandler("focus"),expect(1*n.find(".dropdown-menu tbody td .btn-primary").text().trim()).toBe(s.getDate()),angular.element(n.find(".dropdown-menu tbody td .btn-primary")[0]).triggerHandler("click")}),it("should handle empty values",function(){var t=e("default");t.val(""),angular.element(t[0]).triggerHandler("change"),expect(r.selectedDate).toBeNull()}),it("should support ngRepeat markup",function(){var t=e("markup-ngRepeat");angular.element(t.find("[bs-datepicker]:eq(0)")).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody td").length).toBe(42),expect(n.find(".dropdown-menu tbody .btn").length).toBe(42)}),it("should support ngChange markup",function(){var t=e("markup-ngChange");angular.element(t[0]).triggerHandler("focus");var a=spyOn(r,"onChange").and.callThrough();angular.element(n.find(".dropdown-menu tbody .btn:eq(1)")[0]).triggerHandler("click"),expect(a).toHaveBeenCalled()}),it("should support ngRequired markup",function(){var t=e("markup-ngRequired"),a=new Date(2010,1,22);expect(t.val()).not.toBe(""),expect(r.selectedDate).toBeDefined(),expect(r.selectedDate).toEqual(a),angular.element(t[0]).triggerHandler("focus"),expect(1*n.find(".dropdown-menu tbody td .btn-primary").text().trim()).toBe(a.getDate()),expect(t.val()).toBe(a.getMonth()+1+"/"+a.getDate()+"/"+(a.getFullYear()+"").substr(2))}),it("should consider empty value valid-date with ngRequired markup",function(){var t=e("markup-ngRequired");expect(t.hasClass("ng-valid")).toBe(!0),expect(t.hasClass("ng-valid-required")).toBe(!0),angular.element(t[0]).triggerHandler("focus"),t.val(""),angular.element(t[0]).triggerHandler("change"),expect(t.hasClass("ng-valid-date")).toBe(!0),expect(t.hasClass("ng-invalid")).toBe(!0),expect(t.hasClass("ng-invalid-required")).toBe(!0)}),it("should consider empty value valid-parse without ngRequired markup",function(){var t=e("default");expect(t.hasClass("ng-valid")).toBe(!0),angular.element(t[0]).triggerHandler("focus"),t.val(""),angular.element(t[0]).triggerHandler("change"),expect(t.hasClass("ng-valid-date")).toBe(!0),expect(t.hasClass("ng-valid")).toBe(!0)}),describe("for each month of the year",function(){var t,a,o,d=0;beforeEach(function(){jasmine.addMatchers({toBeNextDayOrFirstDay:function(e,t){return{compare:function(e,t){var n={},a=t;return n.pass=e===a+1||1===e,n.message="Expected "+e+" to be either "+(a+1)+" or 1",n}}}}),t=e("default",{selectedDate:new Date(2012,d,1)}),angular.element(t[0]).triggerHandler("focus"),a=1*n.find(".dropdown-menu tbody .btn:eq(0)").text(),o=a-1}),afterEach(function(){d++});for(var i=0;12>i;i++)it("should correctly order month days in inner content",function(){for(var e=0;42>e;e++){var t=1*n.find(".dropdown-menu tbody td .btn:eq("+e+")").text();expect(t).toBeNextDayOrFirstDay(o),o=t}})})}),describe("resource allocation",function(){it("should not create additional scopes after first show",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),d.flush(),expect(n.children(".dropdown-menu.datepicker").length).toBe(1),angular.element(t[0]).triggerHandler("blur"),d.flush(),expect(n.children(".dropdown-menu.datepicker").length).toBe(0);for(var a=countScopes(r,0),o=0;10>o;o++)angular.element(t[0]).triggerHandler("focus"),d.flush(),angular.element(t[0]).triggerHandler("blur"),d.flush();expect(countScopes(r,0)).toBe(a)}),it("should not create additional scopes when changing months",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),d.flush(),expect(n.children(".dropdown-menu.datepicker").length).toBe(1);for(var a=countScopes(r,0),o=0;10>o;o++)angular.element(n.find(".dropdown-menu thead button:eq(2)")[0]).triggerHandler("click"),r.$digest();expect(countScopes(r,0)).toBe(a)}),it("should destroy scopes when destroying directive scope",function(){var t=countScopes(r,0),n=r;r=r.$new();for(var a=e("default"),o=0;10>o;o++)angular.element(a[0]).triggerHandler("focus"),d.flush(),angular.element(a[0]).triggerHandler("blur"),d.flush();r.$destroy(),r=n,expect(countScopes(r,0)).toBe(t)})}),describe("bsShow attribute",function(){it("should support setting to a boolean value",function(){e("bsShow-attr"),expect(n.children(".dropdown-menu.datepicker").length).toBe(1)}),it("should support binding",function(){e("bsShow-binding"),expect(r.isVisible).toBeFalsy(),expect(n.children(".dropdown-menu.datepicker").length).toBe(0),r.isVisible=!0,r.$digest(),expect(n.children(".dropdown-menu.datepicker").length).toBe(1),r.isVisible=!1,r.$digest(),expect(n.children(".dropdown-menu.datepicker").length).toBe(0)}),it("should support initial value false",function(){e("bsShow-binding"),expect(r.isVisible).toBeFalsy(),expect(n.children(".dropdown-menu.datepicker").length).toBe(0)}),it("should support initial value true",function(){e("bsShow-binding",{isVisible:!0}),expect(r.isVisible).toBeTruthy(),expect(n.children(".dropdown-menu.datepicker").length).toBe(1)}),it("should support undefined value",function(){e("bsShow-binding",{isVisible:void 0}),expect(n.children(".dropdown-menu.datepicker").length).toBe(0)}),it("should support string value",function(){e("bsShow-binding",{isVisible:"a string value"}),expect(n.children(".dropdown-menu.datepicker").length).toBe(0),r.isVisible="TRUE",r.$digest(),expect(n.children(".dropdown-menu.datepicker").length).toBe(1),r.isVisible="dropdown",r.$digest(),expect(n.children(".dropdown-menu.datepicker").length).toBe(0),r.isVisible="datepicker,tooltip",r.$digest(),expect(n.children(".dropdown-menu.datepicker").length).toBe(1)})}),describe("show / hide events",function(){it("should dispatch show and show.before events",function(){var e=l(n,null,{scope:r,options:p["default"].scope}),t=spyOn(e.$scope,"$emit");r.$digest(),e.show(),expect(t).toHaveBeenCalledWith("tooltip.show.before",e),expect(t).not.toHaveBeenCalledWith("tooltip.show",e),d.flush(),expect(t).toHaveBeenCalledWith("tooltip.show",e)}),it("should dispatch hide and hide.before events",function(){var e=l(n,null,{scope:r,options:p["default"].scope});r.$digest(),e.show();var t=spyOn(e.$scope,"$emit");e.hide(),expect(t).toHaveBeenCalledWith("tooltip.hide.before",e),expect(t).not.toHaveBeenCalledWith("tooltip.hide",e),d.flush(),expect(t).toHaveBeenCalledWith("tooltip.hide",e)}),it("should call show.before event with popover element instance id",function(){var t=e("default-with-id"),n="";r.$on("tooltip.show.before",function(e,t){n=t.$id}),angular.element(t[0]).triggerHandler("focus"),r.$digest(),expect(n).toBe("datepicker1")})}),describe("options",function(){describe("animation",function(){it("should default to `am-fade` animation",function(){var t=e("default");angular.element(t[0]).triggerHandler("focus"),expect(n.children(".dropdown-menu").hasClass("am-fade")).toBeTruthy()}),it("should support custom animation",function(){var t=e("options-animation");angular.element(t[0]).triggerHandler("focus"),expect(n.children(".dropdown-menu").hasClass("am-flip-x")).toBeTruthy()})}),describe("autoclose",function(){it("should close on select if truthy",function(){var t=e("options-autoclose",{autoclose:"true"});expect(n.children(".dropdown-menu.datepicker").length).toBe(0),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:first")).triggerHandler("click"),c.flush(),expect(n.children(".dropdown-menu.datepicker").length).toBe(0)}),it("should NOT close on select if falsy",function(){var t=e("options-autoclose",{autoclose:"false"});expect(n.children(".dropdown-menu.datepicker").length).toBe(0),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:first")).triggerHandler("click"),c.flush(),expect(n.children(".dropdown-menu.datepicker").length).not.toBe(0)})}),describe("placement",function(){var t;beforeEach(inject(function(e){t=e})),it("should default to `bottom-left` placement",function(){var a=e("default");angular.element(a[0]).triggerHandler("focus"),t.flush(),expect(n.children(".dropdown-menu").hasClass("bottom-left")).toBeTruthy()}),it("should support placement",function(){var a=e("options-placement");angular.element(a[0]).triggerHandler("focus"),t.flush(),expect(n.children(".dropdown-menu").hasClass("bottom")).toBeTruthy()}),it("should support exotic-placement",function(){var a=e("options-placement-exotic");angular.element(a[0]).triggerHandler("focus"),t.flush(),expect(n.children(".dropdown-menu").hasClass("bottom-right")).toBeTruthy()})}),describe("trigger",function(){it("should support an alternative trigger",function(){var t=e("options-trigger");expect(n.children(".dropdown-menu").length).toBe(0),angular.element(t[0]).triggerHandler("mouseenter"),expect(n.children(".dropdown-menu").length).toBe(1),angular.element(t[0]).triggerHandler("mouseleave"),expect(n.children(".dropdown-menu").length).toBe(0)})}),describe("template",function(){it("should support custom template",function(){o.put("custom",'<div class="dropdown-menu"><div class="dropdown-inner">foo: {{selectedDate}}</div></div>');var t=e("options-template");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-inner").text()).toBe('foo: "'+r.selectedDate.toISOString()+'"')}),it("should support template with ngRepeat",function(){o.put("custom",'<div class="dropdown-menu"><div class="dropdown-inner"><ul><li ng-repeat="i in [1, 2, 3]">{{i}}</li></ul></div></div>');var t=e("options-template");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-inner").text()).toBe("123"),angular.element(t[0]).triggerHandler("blur"),angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-inner").text()).toBe("123")}),it("should support template with ngClick",function(){o.put("custom",'<div class="dropdown-menu"><div class="dropdown-inner"><a class="btn" ng-click="dropdown.counter=dropdown.counter+1">click me</a></div></div>');var t=e("options-template");r.dropdown={counter:0},angular.element(t[0]).triggerHandler("focus"),expect(angular.element(n.find(".dropdown-inner > .btn")[0]).triggerHandler("click")),expect(r.dropdown.counter).toBe(1),angular.element(t[0]).triggerHandler("blur"),angular.element(t[0]).triggerHandler("focus"),expect(angular.element(n.find(".dropdown-inner > .btn")[0]).triggerHandler("click")),expect(r.dropdown.counter).toBe(2)})}),describe("type",function(){it("should support string type with a dateFormat",function(){var t=e("options-typeStringDateFormat");expect(t.val()).toBe("22/02/1986"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(16)")).triggerHandler("click"),expect(t.val()).toBe("16/02/1986")}),it("should support string type with an alternative dateFormat",function(){var t=e("options-typeStringDateFormatAlternative");expect(t.val()).toBe("2014-04-11"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(16)")).triggerHandler("click"),expect(t.val()).toBe("2014-04-16")}),it("should support number type with a dateFormat",function(){var t=e("options-typeNumberDateFormat");expect(t.val()).toBe("3/22/86"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(16)")).triggerHandler("click"),expect(t.val()).toBe("3/16/86")}),it("should support unix type with a dateFormat",function(){var t=e("options-typeUnixDateFormat");expect(t.val()).toBe("3/22/86"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(16)")).triggerHandler("click"),expect(t.val()).toBe("3/16/86")}),it("should support iso type with a dateFormat",function(){var t=e("options-typeIsoDateFormat");expect(t.val()).toBe("12/26/14"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(16)")).triggerHandler("click"),expect(t.val()).toBe("12/16/14")})}),describe("dateFormat",function(){it("should support a custom dateFormat",function(){var t=e("options-dateFormat");expect(t.val()).toBe("1986-02-22"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(24)")).triggerHandler("click"),expect(t.val()).toBe("1986-02-24")}),it("should support an alternative custom dateFormat",function(){var t=e("options-dateFormat-alt");expect(t.val()).toBe("Saturday February 22, 1986"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(24)")).triggerHandler("click"),expect(t.val()).toBe("Monday February 24, 1986")}),it("should support a custom named dateFormat",function(){var t=e("options-named-dateFormat");expect(t.val()).toBe("Feb 22, 1986"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(24)")).triggerHandler("click"),expect(t.val()).toBe("Feb 24, 1986")})}),describe("timezone",function(){var t,a=0,o=[new Date(2014,0,1),new Date(2015,0,1),new Date(2014,11,31),new Date(2015,11,31),new Date(2014,7,1),new Date(2015,7,1),new Date(1985,0,11)];beforeEach(function(){t=e("options-timezone-utc",{selectedDate:o[a]})}),afterEach(function(){a++});for(var d=0;d<o.length;d++)it("should select date in utc timezone",function(){expect(t.val()).toBe(i(o[a],"yyyy-MM-dd","UTC")),expect(r.selectedDate.toDateString()).toBe(o[a].toDateString()),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(15)")).triggerHandler("click"),expect(t.val()).toBe(i(o[a],"yyyy-MM-'15'","UTC"))})}),describe("strictFormat",function(){it("should support strict format date parse",function(){var t=e("options-strictFormat");expect(t.val()).toBe("1986-2-4"),t.val("1996-4-7"),angular.element(t[0]).triggerHandler("change"),expect(t.val()).toBe("1996-4-7"),expect(t.hasClass("ng-valid")).toBe(!0)})}),describe("minDate",function(){it("should support a dynamic minDate",function(){var t=e("options-minDate");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(19)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),r.minDate="02/12/86",r.$digest(),expect(n.find(".dropdown-menu tbody button:contains(11)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(12)").is(":disabled")).toBeFalsy()}),it("should support today as minDate",function(){var t=e("options-minDate-today");angular.element(t[0]).triggerHandler("focus");var a=s.getDate();expect(n.find(".dropdown-menu tbody button[disabled]").length>0).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains("+a+").btn-primary").length).toBe(1),expect(n.find(".dropdown-menu tbody button:contains("+a+").btn-primary").is(":disabled")).toBeFalsy()}),it("should support number as minDate",function(){var t=e("options-minDate-number");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(19)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy()}),it("should support Date object as minDate",function(){var t=e("options-minDate-date");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(19)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy()}),it("should trigger validation when minDate changes",function(){var t=e("options-minDate-date");expect(t.hasClass("ng-valid")).toBe(!0),r.minDate=new Date(1986,1,25),r.$digest(),expect(t.hasClass("ng-valid")).toBe(!1),r.minDate=new Date(1986,1,18),r.$digest(),expect(t.hasClass("ng-valid")).toBe(!0)}),it("should reset minDate to -Infinity when set empty string",function(){var t=e("options-minDate");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(19)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),r.minDate="",r.$digest(),expect(n.find(".dropdown-menu tbody button:contains(19)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy()})}),describe("maxDate",function(){it("should support a dynamic maxDate",function(){var t=e("options-maxDate");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeTruthy(),r.maxDate="02/12/86",
r.$digest(),expect(n.find(".dropdown-menu tbody button:contains(13)").is(":disabled")).toBeTruthy()}),it("should support today as maxDate",function(){var t=e("options-maxDate-today");angular.element(t[0]).triggerHandler("focus");var a=s.getDate();expect(n.find(".dropdown-menu tbody button[disabled]").length>0).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains("+a+").btn-primary").length).toBe(1),expect(n.find(".dropdown-menu tbody button:contains("+a+").btn-primary").is(":disabled")).toBeFalsy()}),it("should support number as maxDate",function(){var t=e("options-maxDate-number");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeTruthy()}),it("should support Date object as maxDate",function(){var t=e("options-maxDate-date");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeTruthy()}),it("should trigger validation when maxDate changes",function(){var t=e("options-maxDate-date");expect(t.hasClass("ng-valid")).toBe(!0),r.maxDate=new Date(1986,1,20),r.$digest(),expect(t.hasClass("ng-valid")).toBe(!1),r.maxDate=new Date(1986,1,26),r.$digest(),expect(t.hasClass("ng-valid")).toBe(!0)}),it("should reset maxDate to +Infinity when set empty string",function(){var t=e("options-maxDate");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeTruthy(),r.maxDate="",r.$digest(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy()})}),describe("startWeek",function(){it("should support a dynamic startWeek",function(){var t=e("options-startWeek");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu thead tr:eq(1) th:eq(0)").text()).toBe("Mon"),expect(n.find(".dropdown-menu tbody button:eq(0)").text()).toBe("27")}),it("should support a negative gap induced by startWeek",function(){var t=e("options-startWeek-bis");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu thead tr:eq(1) th:eq(0)").text()).toBe("Sat"),expect(n.find(".dropdown-menu tbody button:eq(0)").text()).toBe("28")})}),describe("startDate",function(){it("should support a dynamic startDate",function(){var t=e("options-startDate");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu thead button:eq(1)").text()).toBe(i(new Date(r.startDate),"MMMM yyyy"))}),it("should support a dynamic startDate from date object",function(){var t=e("options-startDate",{startDate:new Date(2014,2,2)});angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu thead button:eq(1)").text()).toBe(i(r.startDate,"MMMM yyyy"))})}),describe("useNative",function(){it("should correctly compile template according to useNative",function(){var t=e("options-useNative");angular.element(t[0]).triggerHandler("focus")})}),describe("container",function(){it("should append to container if defined",function(){var t=$('<div id="testElm"></div>');n.append(t);var a=e("options-container",{container:"#testElm"});angular.element(a[0]).triggerHandler("focus"),expect(t.find(".datepicker").length).toBe(1)}),it("should put datepicker in sandbox when container is falsy",function(){var t=e("options-container",{container:"false"});angular.element(t[0]).triggerHandler("focus"),expect(n.find(".datepicker").length).toBe(1)})})}),describe("dateModelFormat",function(){it("should support a custom modelDateFormat",function(){var t=e("options-modelDateFormat");expect(t.val()).toBe("01/12/2014"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(24)")).triggerHandler("click"),expect(t.val()).toBe("24/12/2014"),expect(r.selectedDate).toBe("2014-12-24"),t.val("20/11/2014"),angular.element(t[0]).triggerHandler("change"),r.$digest(),expect(r.selectedDate).toBe("2014-11-20")}),it("should support longDate modelDateFormat",function(){var t=e("options-modelDateFormat-longDate");expect(t.val()).toBe("12/1/14"),angular.element(t[0]).triggerHandler("focus"),angular.element(n.find(".dropdown-menu tbody .btn:contains(24)")).triggerHandler("click"),expect(t.val()).toBe("12/24/14"),expect(r.selectedDate).toBe("December 24, 2014"),t.val("11/20/14"),angular.element(t[0]).triggerHandler("change"),r.$digest(),expect(r.selectedDate).toBe("November 20, 2014")})}),describe("daysOfWeekDisabled",function(){it("should enable all days of the week by default",function(){var t=e("options-daysOfWeekDisabled");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeFalsy()}),it("should allow disabling some days of the week",function(){var t=e("options-daysOfWeekDisabled-bis");angular.element(t[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeTruthy()})}),describe("disabledDates",function(){it("should not disable any dates by default",function(){var t={disabledDates:[]},a=e("options-disabledDates",t);angular.element(a[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeFalsy()}),it("should disable a single date range",function(){var t={disabledDates:[{start:new Date(2014,6,22),end:new Date(2014,6,25)}]},a=e("options-disabledDates",t);angular.element(a[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeFalsy()}),it("should disable multiple sorted date ranges",function(){var t={disabledDates:[{start:new Date(2014,6,21),end:new Date(2014,6,22)},{start:new Date(2014,6,24),end:new Date(2014,6,24)}]},a=e("options-disabledDates",t);angular.element(a[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeFalsy()}),it("should disable multiple sorted date ranges out of order",function(){var t={disabledDates:[{start:new Date(2014,6,24),end:new Date(2014,6,24)},{start:new Date(2014,6,21),end:new Date(2014,6,22)}]},a=e("options-disabledDates",t);angular.element(a[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeFalsy()}),it("should work combined with minDate/maxDate",function(){var t={disabledDates:[{start:new Date(2014,6,23),end:new Date(2014,6,24)}]},a=e("options-disabledDates-minmax",t);angular.element(a[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeTruthy()}),it("should work combined with daysOfWeekDisabled",function(){var t={disabledDates:[{start:new Date(2014,6,22),end:new Date(2014,6,22)}]},a=e("options-disabledDates-daysOfWeek",t);angular.element(a[0]).triggerHandler("focus"),expect(n.find(".dropdown-menu tbody button:contains(20)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(21)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(22)").is(":disabled")).toBeTruthy(),expect(n.find(".dropdown-menu tbody button:contains(23)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(24)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(25)").is(":disabled")).toBeFalsy(),expect(n.find(".dropdown-menu tbody button:contains(26)").is(":disabled")).toBeFalsy()})}),describe("datepickerViews",function(){var e;beforeEach(inject(function(){e={select:function(e,t){},$options:{startWeek:0,daysOfWeekDisabled:"",dateFormat:"shortDate"},$date:null},spyOn(e,"select")})),it("should change the day when navigating with the keyboard in the day view",inject(function(t){var n=t(e);e.$date=new Date(2014,0,6),n.views[0].onKeyDown({keyCode:37}),expect(e.select).toHaveBeenCalledWith(new Date(2014,0,5),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[0].onKeyDown({keyCode:38}),expect(e.select).toHaveBeenCalledWith(new Date(2013,11,30),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[0].onKeyDown({keyCode:39}),expect(e.select).toHaveBeenCalledWith(new Date(2014,0,7),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[0].onKeyDown({keyCode:40}),expect(e.select).toHaveBeenCalledWith(new Date(2014,0,13),!0),e.select.calls.reset(),e.$date=null,n.views[0].onKeyDown({keyCode:40}),expect(e.select).not.toHaveBeenCalled()})),it("should change the month when navigating with the keyboard in the month view",inject(function(t){var n=t(e);e.$date=new Date(2014,0,6),n.views[1].onKeyDown({keyCode:37}),expect(e.select).toHaveBeenCalledWith(new Date(2013,11,6),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[1].onKeyDown({keyCode:38}),expect(e.select).toHaveBeenCalledWith(new Date(2013,8,6),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[1].onKeyDown({keyCode:39}),expect(e.select).toHaveBeenCalledWith(new Date(2014,1,6),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[1].onKeyDown({keyCode:40}),expect(e.select).toHaveBeenCalledWith(new Date(2014,4,6),!0),e.select.calls.reset(),e.$date=null,n.views[1].onKeyDown({keyCode:40}),expect(e.select).not.toHaveBeenCalled()})),it("should change the year when navigating with the keyboard in the year view",inject(function(t){var n=t(e);e.$date=new Date(2014,0,6),n.views[2].onKeyDown({keyCode:37}),expect(e.select).toHaveBeenCalledWith(new Date(2013,0,6),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[2].onKeyDown({keyCode:38}),expect(e.select).toHaveBeenCalledWith(new Date(2010,0,6),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[2].onKeyDown({keyCode:39}),expect(e.select).toHaveBeenCalledWith(new Date(2015,0,6),!0),e.select.calls.reset(),e.$date=new Date(2014,0,6),n.views[2].onKeyDown({keyCode:40}),expect(e.select).toHaveBeenCalledWith(new Date(2018,0,6),!0),e.select.calls.reset(),e.$date=null,n.views[2].onKeyDown({keyCode:40}),expect(e.select).not.toHaveBeenCalled()}))}),describe("prefix",function(){it("should call namespaced events from provider",function(){var e=l(n,null,{prefixEvent:"dp",scope:r}),t=spyOn(e.$scope,"$emit");r.$digest(),e.show(),e.hide(),d.flush(),expect(t).toHaveBeenCalledWith("dp.show.before",e),expect(t).toHaveBeenCalledWith("dp.show",e),expect(t).toHaveBeenCalledWith("dp.hide.before",e),expect(t).toHaveBeenCalledWith("dp.hide",e)}),it("should call namespaced events from directive",function(){var t,n,a,o,i=e("default-with-namespace");r.$on("modal.show.before",function(){t=!0}),r.$on("modal.show",function(){n=!0}),r.$on("modal.hide.before",function(){a=!0}),r.$on("modal.hide",function(){o=!0}),angular.element(i[0]).triggerHandler("focus"),d.flush(),expect(t).toBe(!0),expect(n).toBe(!0),angular.element(i[0]).triggerHandler("blur"),d.flush(),expect(a).toBe(!0),expect(o).toBe(!0)})})});