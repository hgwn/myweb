angular.module("widget.scrollbar",[]).directive("ngScrollbar",[function(){return{restrict:"AE",transclude:!0,scope:{scrollbarConfig:"=scrollbarConfig",scrollbarX:"@",scrollbarY:"@"},template:'<div style="position:relative;width:100%;height:100%;">                            <div class="ngscroll-content-container" style="float:left;display:inline-block;margin-top:0;margin-left:0;width: 100%;" ng-transclude>                            </div>                            <ng-scrollbar-x ng-if="scrollbarX || scrollbarX === undefined"></ng-scrollbar-x>                            <ng-scrollbar-y ng-if="scrollbarY || scrollbarY === undefined"></ng-scrollbar-y>                       </div>',controller:"scrollbarController",compile:function(n){return n.css("overflow","hidden"),function(n,e,r,o){o.init(e,n.scrollbarConfig)}}}}]).controller("scrollbarController",[function(){var n,e,r,o,t,i={dragSpeed:1,autoResize:!1,autoScroll:!0,show:!1,scrollbar:{width:6,hoverWidth:8,color:"rgba(0,0,0,.6)"},scrollbarContainer:{width:12,color:"rgba(0,0,0,.1)"}};this.init=function(l,s){n=l,r=angular.copy(angular.extend(i,s||{})),e=angular.element(l[0].querySelector(".ngscroll-content-container")),o=(r.scrollbarContainer.width-r.scrollbar.width)/2,t=(r.scrollbarContainer.width-r.scrollbar.hoverWidth)/2},angular.extend(this,{winEl:angular.element(window),getContainerElement:function(){return n},getContentElement:function(){return e},getConfig:function(){return r},getScrollbarMargin:function(){return o},getScrollbarHoverMargin:function(){return t}})}]).directive("ngScrollbarY",["$timeout",function(n){return{restrict:"AE",require:"^ngScrollbar",replace:!0,template:'<div class="ngscrollbar-container-y" ng-style="styles.scrollbarContainer"><div class="ngscrollbar-y" ng-style="styles.scrollbar"></div></div>',compile:function(){return function(e,r,o,t){var i=t.getConfig(),l=angular.element(document),s=t.getContainerElement(),a=t.getContentElement(),c=angular.element(r[0].querySelector(".ngscrollbar-y")),u=t.getScrollbarMargin(),d=t.getScrollbarHoverMargin();e.styles={scrollbarContainer:{position:"absolute",width:i.scrollbarContainer.width+"px",height:"100%",zIndex:1e3,top:0,right:0,transition:"background .3s ease-in-out","border-radius":i.scrollbarContainer.width/2+"px"},scrollbar:{position:"absolute",width:i.scrollbar.width+"px",right:u+"px",cursor:"default",opacity:0,transition:"opacity .3s ease-in-out, border-radius .1s linear, width .1s linear, right .1s linear",background:i.scrollbar.color,"border-radius":i.scrollbar.width/2+"px"}};var g=function(){return a[0].offsetHeight},f=function(){return s[0].offsetHeight},b=function(){var n=Math.max(Math.pow(f(),2)/g()-2*u,10);return n},h=function(){return g()>f()},p=function(){c.css("opacity",0)},m=function(){c.css("opacity",1)},v=function(){var n=parseInt(a.css("margin-top"),10);a.css("margin-top","0px"),h()?(r.css("display","block"),c.css("height",b()+"px"),w(n),i.show&&m()):r.css("display","none")},w=function(n){n=Math.min(0,Math.max(n,f()-g())),a.css("margin-top",n+"px"),c.css("top",-n/g()*f()+u+"px")},x=function(){var n=Math.min(0,f()-g());a.css("margin-top",n+"px"),c.css("top",-n/g()*f()+u+"px")},y=!1,C=function(n){var r=f()-g(),o=parseInt(a.css("margin-top"),10)+n;w(o),r>o&&!y&&(e.$emit("pullToLoadingStart"),y=!0)};e.$on("pullToLoadingEnd",function(){y=!1}),s.on("mousewheel",function(n){h()&&(n.preventDefault(),void 0!==n.originalEvent&&(n=n.originalEvent),C(n.wheelDeltaY||n.wheelDelta))}),window.navigator.userAgent.toLowerCase().indexOf("firefox")>=0&&s.on("wheel",function(n){h()&&(n.preventDefault(),void 0!==n.originalEvent&&(n=n.originalEvent),C(40*-n.deltaY))}),r.on("mouseenter",function(){r.css("background",i.scrollbarContainer.color),c.css("width",i.scrollbar.hoverWidth+"px"),c.css("right",d+"px"),c.css("border-radius",i.scrollbar.hoverWidth/2+"px")}),r.on("mouseleave",function(){r.css("background","none"),c.css("width",i.scrollbar.width+"px"),c.css("right",u+"px"),c.css("border-radius",i.scrollbar.width/2+"px")});var S,M=!1,E=!1;i.show||(s.on("mouseenter",function(){E=!0,m()}),s.on("mouseleave",function(){E=!1,M||p()})),c.on("mousedown",function(n){n.preventDefault(),S=n.screenY,M=!0,l.one("mouseup",function(){M=!1,i.show||E||p()})}),l.on("mousemove",function(n){M&&(n.preventDefault(),C(-(n.screenY-S)*i.dragSpeed*g()/f()),S=n.screenY)}),n(function(){if(v(),document.createStyleSheet)a.on("DOMNodeInserted",v),a.on("DOMNodeRemoved",v);else{var n=new MutationObserver(function(n){n.length&&v()});n.observe(a[0],{childList:!0,subtree:!0}),e.$on("activeModuleChanged",function(n,e){v()}),e.$on("renderFinished",function(n,e){v()}),e.$on("messageDelivered",function(){v()}),e.$on("resetScrollBar",function(){v()})}},5),e.$on("scrollToBottom",function(n,e){x()}),i.autoScroll&&e.$on("autoScroll",function(n,e){w(f()/2-e.element[0].offsetTop)}),i.autoResize&&!function(){var n;t.winEl.on("resize",function(e){n&&clearTimeout(n),n=setTimeout(function(){n=null,v()},50)})}()}}}}]).directive("ngScrollbarX",["$timeout",function(n){return{restrict:"AE",replace:!0,require:"^ngScrollbar",template:'<div class="ngscrollbar-container-x" ng-style="styles.scrollbarContainer"><div class="ngscrollbar-x" ng-style="styles.scrollbar"></div></div>',compile:function(){return function(e,r,o,t){var i=t.getConfig(),l=angular.element(document),s=t.getContainerElement(),a=s[0],c=t.getContentElement(),u=angular.element(r[0].querySelector(".ngscrollbar-x")),d=t.getScrollbarMargin(),g=t.getScrollbarHoverMargin();e.styles={scrollbarContainer:{position:"absolute",width:"100%",transition:"background .3s ease-in-out","border-radius":i.scrollbarContainer.width/2+"px"},scrollbar:{position:"absolute",cursor:"default",opacity:0,transition:"opacity .3s ease-in-out, border-radius .1s linear, width .1s linear, right .1s linear",background:i.scrollbar.color,"border-radius":i.scrollbar.width/2+"px"}},r.css("height",i.scrollbarContainer.width+"px"),r.css("bottom",0),r.css("left",0),u.css("top",d+"px"),u.css("height",i.scrollbar.width+"px");var f=function(){return c[0].offsetWidth},b=function(){return a.offsetWidth},h=function(){return Math.pow(b(),2)/f()-2*d},p=function(){u.css("opacity",1)},m=function(){u.css("opacity",0)},v=function(){return f()>b()},w=function(){var n=parseInt(c.css("margin-left"),10);c.css("margin-left","0px"),v()?(r.css("display","block"),u.css("width",h()+"px"),x(n),i.show&&p()):r.css("display","none")},x=function(n){n=Math.min(0,Math.max(n,b()-f())),c.css("margin-left",n+"px"),u.css("left",-n/f()*b()+d+"px")},y=function(n){var e=parseInt(c.css("margin-left"),10)+n;x(e)};r.on("mouseenter",function(){r.css("background",i.scrollbarContainer.color),u.css("height",i.scrollbar.hoverWidth+"px"),u.css("top",g+"px"),u.css("border-radius",i.scrollbar.hoverWidth/2+"px")}),r.on("mouseleave",function(){r.css("background","none"),u.css("height",i.scrollbar.width+"px"),u.css("top",d+"px"),u.css("border-radius",i.scrollbar.width/2+"px")});var C,S=!1,M=!1;i.show||(s.on("mouseenter",function(){M=!0,p()}),s.on("mouseleave",function(){M=!1,S||m()})),u.on("mousedown",function(n){n.preventDefault(),S=!0,C=n.screenX,l.one("mouseup",function(){S=!1,i.show||M||m()})}),l.on("mousemove",function(n){S&&(n.preventDefault(),y(-(n.screenX-C)*i.dragSpeed*f()/b()),C=n.screenX)}),n(function(){if(w(),document.createStyleSheet)c.on("DOMNodeInserted",w),c.on("DOMNodeRemoved",w);else{var n=new MutationObserver(function(n){n.length&&w()});n.observe(c[0],{childList:!0,subtree:!0})}},5),i.autoResize&&!function(){var n;t.winEl.on("resize",function(e){n&&clearTimeout(n),n=setTimeout(function(){n=null,w()},50)})}()}}}}]);