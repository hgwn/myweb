(function(){var n;n=angular.module("selectAddress",[]),n.directive("selectAddress",["$http","$q","$compile",function(n,e,t){var i,r,c;return r=e.defer(),c="/masgetweb/static/js/plugins/angular.plugins/address-selector/template/box.html",i="/masgetweb/static/js/plugins/angular.plugins/address-selector/js/data/pca.json",n.get(i).success(function(n){return r.resolve(n)}),{restrict:"A",scope:{ngModel:"=",pcaIds:"="},link:function(e,i,u){var s;return s={element:null,backdrop:null,show:function(){return primaryP=e.p,primaryC=e.c,primaryA=e.a,primaryD=e.d,this.element.addClass("active")},hide:function(){return this.element.removeClass("active"),this.resize(),!1},resize:function(){return this.element?(this.element.css({top:-this.element.height()-30,"margin-left":-this.element.width()/2}),!1):void 0},cancle:function(){return e.p=primaryP,e.c=primaryC,e.a=primaryA,e.d=primaryD,this.hide(),!1},focus:function(){return $('[ng-model="d"]').focus(),!1},init:function(){return i.on("focus keydown",function(){return s.show(),!1}),$(window).on("click",function(n){return function(){}}(this)),this.element.on("click",function(){}),setTimeout(function(n){return function(){return n.element.show(),n.resize()}}(this),500)}},r.promise.then(function(i){return n.get(c).success(function(n){var r;return r=t(n)(e),$("body").append(r),s.element=$(r[2]),e.provinces=i,s.init()}),e.aSet={p:function(n){return e.p=n.p,e.pid=n.provinceid,e.c=null,e.a=null,e.d=null},c:function(n){return e.c=n.n,e.cid=n.cityid,e.a=null,e.d=null},a:function(n){return e.a=n.s,e.aid=n.areaid,e.d=null,s.focus()}},e.clear=function(){return e.ngModel="",e.pcaIds="",e.p=null,e.c=null,e.a=null,e.d=null,s.hide()},e.cancle=function(){return s.cancle()},e.submit=function(){return e.ngModel="",e.pcaIds="",e.p&&(e.ngModel+=e.p,e.pcaIds+=e.pid),e.c&&(e.ngModel+=" "+e.c,e.pcaIds+="&"+e.cid),e.a&&(e.ngModel+=" "+e.a,e.pcaIds+="&"+e.aid),e.d&&(e.ngModel+=" "+e.d),s.resize(),s.hide()},e.$watch("p",function(n){var t,r,c,u;if(n){for(u=[],r=0,c=i.length;c>r;r++)t=i[r],t.p===n&&u.push(e.cities=t.c);return u}return e.cities=null}),e.$watch("c",function(n){var t,i,r,c,u;if(n){for(c=e.cities,u=[],i=0,r=c.length;r>i;i++)t=c[i],t.n===n&&u.push(e.dists=t.a);return u}return e.dists=[]}),e.$watch(function(){return s.resize()})})}}}])}).call(this);